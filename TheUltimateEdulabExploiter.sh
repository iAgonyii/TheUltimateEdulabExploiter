
#!/bin/bash
which python sh
set -a; source config.sh; set +a

print_banner()
{
	echo "███████╗██████╗ ██╗   ██╗██╗      █████╗ ██████╗ "
	echo "██╔════╝██╔══██╗██║   ██║██║     ██╔══██╗██╔══██╗"
	echo "█████╗  ██║  ██║██║   ██║██║     ███████║██████╔╝"
	echo "██╔══╝  ██║  ██║██║   ██║██║     ██╔══██║██╔══██╗"
	echo "███████╗██████╔╝╚██████╔╝███████╗██║  ██║██████╔╝"
	echo "╚══════╝╚═════╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝╚═════╝ "
	echo
	echo
	echo
}

scan_siemens_controls()
{
	git clone https://github.com/dark-lbp/isf scripts/isf && echo "Cloned ISF..." || "ISF already cloned or error..."
	python scripts/s7scan.py
}

scan_rockwell_controls()
{
	nmap -e $interface -sU -p44818 --script enip-info $rockwell_controls
}

print_banner

while true; do
  echo "****************************************************************"
  options=("Scan for Siemens controllers" "Scan for Rockwell controllers" "Quit")
  echo "Please enter your choice: "
  select opt in "${options[@]}"; do
    case $REPLY in
      1) scan_siemens_controls; break ;;
      2) scan_rockwell_controls; break ;;
      3) break 2 ;;
      *) echo "Incorrect option" >&2
    esac
  done
done

echo "Bye!"


#print_menu()
#{
#	echo "****************************************************************"
#	PS3='Please enter your choice: '
#	options=("Scan for Siemens controllers" "Scan for Rockwell controllers" "Option 3" "Quit")
#	select opt in "${options[@]}"
#	do
#		case $opt in
#			"Scan for Siemens controllers")
#				scan_siemens_controls
#				;;
#			"Scan for Rockwell controllers")
#				scan_rockwell_controls
#				;;
#			"Option 3")
#				echo "You chose option $REPLY which is $opt"
#				;;
#			"Quit")
#				break
#				;;
#			*) echo "Invalid option $REPLY";;
#		esac
#	done
#}
#print_banner
#print_menu
