
#!/bin/bash
which python sh
set -a; source config.sh; set +a

print_banner()
{
	echo "███████╗██████╗ ██╗   ██╗██╗      █████╗ ██████╗ "
	echo "██╔════╝██╔══██╗██║   ██║██║     ██╔══██╗██╔══██╗"
	echo "█████╗  ██║  ██║██║   ██║██║     ███████║██████╔╝"
	echo "██╔══╝  ██║  ██║██║   ██║██║     ██╔══██║██╔══██╗"
	echo "███████╗██████╔╝╚██████╔╝███████╗██║  ██║██████╔╝"
	echo "╚══════╝╚═════╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝╚═════╝ "
	echo
	echo
}

scan_siemens_controls()
{
	git clone https://github.com/dark-lbp/isf scripts/isf && echo "Cloned ISF..." || "ISF already cloned or error..."
	python scripts/s7scan.py
}

scan_rockwell_controls()
{
	nmap -e $interface -sU -p44818 --script enip-info $rockwell_controls
}

while true; do
  print_banner
  echo "****************************************************************"
  options=("Scan for Siemens controllers" "Scan for Rockwell controllers" "Quit")
  echo "Please enter your choice: "
  select opt in "${options[@]}"; do
    case $REPLY in
      1) scan_siemens_controls; break ;;
      2) scan_rockwell_controls; break ;;
      3) break 2 ;;
      *) echo "Incorrect option" >&2
    esac
  done
done

echo "Bye!"
